---
title: "Models"
editor: visual
execute: 
  echo: false
---

## What is the predicted Field Goal Percentage of the Chicago Bulls for the 2023-2024 NBA Season, given that each player has played more than 30 games?

To answer this question, I filtered the data, selecting all the players of the Chicago Bulls that have played more than 30 games. Using this data, I then created a fitted model, using the Field Goal Percentage of each player as the parameter:

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(rstanarm)
library(readr)
library(janitor)
library(ggplot2)
```

```{r}
#| message: false
#| warning: false
NBA_Data <- read_csv("data/NBA-2022-2023-Data.csv", col_types = cols(
  Player = col_character(),
  Team = col_character(),
  Positions = col_character()
  )
) |> 
  filter(Team == "CHI") |>
    filter(`GP` > 30) |>
      select(`Player`, `FG%`)
```

```{r}
#| message: false
#| warning: false
fit_obj <- stan_glm(data = NBA_Data, 
                    formula = `FG%` ~ 1, 
                    family = gaussian, 
                    refresh = 0,
                    seed = 9)

fit_obj
```
This fitted model of the data was then used to create the posterior estimated prediction model. The Posterior Estimated Prediction model calculates the predicted value based on the data the model was given:

```{r}

newobs <- tibble(.rows = 1)

pe <- posterior_epred(object = fit_obj, newdata = newobs) |> 
  as_tibble()

pe
```


All of the values above are predicted values of the Chicago Bulls' 2023-2024 Field Goal Percentage. Taking the average of these values reveals the most accurate prediction, which is 49.2%. This means that the predicted Field Goal Percentage of the Chicago Bulls for the 2023-2024 NBA Season is 49.2%, given that each player has played more than 30 games during the season.

