---
title: "Chicago Bulls Field Goal Percentage Prediction"
author: "Aryan Kancherla"
execute: 
  echo: false
  warning: false
---
```{r}
#| message: false
library(tidyverse)
library(rstanarm)
library(ggplot2)
```

```{r}
#| message: false
#| warning: false
NBA_Data_1 <- read_csv("data/NBA-2022-2023-Data.csv", col_types = cols(
  Player = col_character(),
  Team = col_character(),
  Positions = col_character()
  ) 
  
  # Importing the csv file and changing the column types of the "Players", "Team", and "Position" columns to characters
  
) |>
  filter(Team == "CHI") |>
    filter(`GP` > 30) |>
      select(`Player`, `FG%`)

new_row <- tibble(Player = "JeVon Carter", `FG%` = 0.423)
NBA_Data <- add_row(NBA_Data_1, .before = 1, !!!new_row)

#Filtered the data, analyzing Chicago Bull players who have played more than 30 games. Then, selecting the "Player" and "FG%" columns from the data

```

```{r}
#| message: false

fit_obj <- stan_glm(data = NBA_Data, 
                    formula = `FG%` ~ 1, 
                    family = gaussian, 
                    refresh = 0,
                    seed = 9)

# Created the fitted model, using a one parameter model

newobs <- tibble(.rows = 1)

pe <- posterior_epred(object = fit_obj, newdata = newobs) |> 
  as_tibble()

# pe is now a tibble which holds all the predicted values of the Chicago Bulls' Field Goal Percentage

```

```{r}
pe |> 
  ggplot(aes(x = `1`)) +
    geom_histogram(aes(y = after_stat(count/sum(count))), fill = "red", color = "black", bins = 100) +
      geom_vline(xintercept = mean(pe$`1`), linetype = "dotted", lwd = 1.5) +
        
      #Used geom_vline (the black dotted line on the histogram) to display the predicted FG% of the Chicago Bulls for the 2023-2024 NBA Season 
  
      #the xintercept value is the mean of all the predicted values, which is the predicted FG% of the Bulls
  
       labs(title = "The Chicago Bulls Predicted Field Goal % for the 2023-2024 NBA Season",
         subtitle = "It is likely that the Field Goal Percentage will be 48.7% next season",
         x = "Estimated FG%",
         y = "Probability",
         caption = "Source: FantasyPros"
         ) +
  scale_x_continuous(labels = scales::number_format(accuracy = 0.01))+
          scale_y_continuous(labels = scales::percent_format()) +
            theme_classic()

```


## Plot Summary

The Chicago Bulls had a great season this year, qualifying for the NBA Play-In Tournament and eliminating the Toronto Raptors. The following data was pulled from FantasyPros, a website that provides fantasy sports data & content. Then, the data was filtered to look at the statistics of all the Chicago Bulls players. Finally, I created a Bayesian Prediction Model estimating the Field Goal Percentage of the Chicago Bulls Team. For the 2023-2024 NBA Season, the Chicago Bulls' predicted average field goal percentage is **48.7%**, represented by the dotted black line on the histogram. 
